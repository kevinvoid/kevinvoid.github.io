---
layout: post
title:  "linux查找命令(mac和linux执行有些许差别)"
date:   2020-05-15 17:00:02 +0800
categories: linux
---

### 开头
- 缘由: 经常使用find、whereis、which做查找操作,在此做个总结.
- 查找的方式: 名称匹配、内容匹配、递归子目录查找

### find命令
- **定义**: 用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则find命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。
- **格式**: find (选项) (参数)
	- 选项:
	```
	-amin<分钟>：查找在指定时间曾被存取过的文件或目录，单位以分钟计算；
	-anewer<参考文件或目录>：查找其存取时间较指定文件或目录的存取时间更接近现在的文件或目录；
	-atime<24小时数>：查找在指定时间曾被存取过的文件或目录，单位以24小时计算；
	-cmin<分钟>：查找在指定时间之时被更改过的文件或目录；
	-cnewer<参考文件或目录>查找其更改时间较指定文件或目录的更改时间更接近现在的文件或目录；
	-ctime<24小时数>：查找在指定时间之时被更改的文件或目录，单位以24小时计算；
	-daystart：从本日开始计算时间；
	-depth：从指定目录下最深层的子目录开始查找；
	-empty：寻找文件大小为0 Byte的文件，或目录下没有任何子目录或文件的空目录；
	-exec<执行指令>：假设find指令的回传值为True，就执行该指令；
	-false：将find指令的回传值皆设为False；
	-fls<列表文件>：此参数的效果和指定“-ls”参数类似，但会把结果保存为指定的列表文件；
	-follow：排除符号连接；
	-fprint<列表文件>：此参数的效果和指定“-print”参数类似，但会把结果保存成指定的列表文件；
	-fprint0<列表文件>：此参数的效果和指定“-print0”参数类似，但会把结果保存成指定的列表文件；
	-fprintf<列表文件><输出格式>：此参数的效果和指定“-printf”参数类似，但会把结果保存成指定的列表文件；
	-fstype<文件系统类型>：只寻找该文件系统类型下的文件或目录；
	-gid<群组识别码>：查找符合指定之群组识别码的文件或目录；
	-group<群组名称>：查找符合指定之群组名称的文件或目录；
	-help或——help：在线帮助；
	-ilname<范本样式>：此参数的效果和指定“-lname”参数类似，但忽略字符大小写的差别；
	-iname<范本样式>：此参数的效果和指定“-name”参数类似，但忽略字符大小写的差别；
	-inum<inode编号>：查找符合指定的inode编号的文件或目录；
	-ipath<范本样式>：此参数的效果和指定“-path”参数类似，但忽略字符大小写的差别；
	-iregex<范本样式>：此参数的效果和指定“-regexe”参数类似，但忽略字符大小写的差别；
	-links<连接数目>：查找符合指定的硬连接数目的文件或目录；
	-iname<范本样式>：指定字符串作为寻找符号连接的范本样式；
	-ls：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出；
	-maxdepth<目录层级>：设置最大目录层级；
	-mindepth<目录层级>：设置最小目录层级；
	-mmin<分钟>：查找在指定时间曾被更改过的文件或目录，单位以分钟计算；
	-mount：此参数的效果和指定“-xdev”相同；
	-mtime<24小时数>：查找在指定时间曾被更改过的文件或目录，单位以24小时计算；
	-name<范本样式>：指定字符串作为寻找文件或目录的范本样式；
	-newer<参考文件或目录>：查找其更改时间较指定文件或目录的更改时间更接近现在的文件或目录；
	-nogroup：找出不属于本地主机群组识别码的文件或目录；
	-noleaf：不去考虑目录至少需拥有两个硬连接存在；
	-nouser：找出不属于本地主机用户识别码的文件或目录；
	-ok<执行指令>：此参数的效果和指定“-exec”类似，但在执行指令之前会先询问用户，若回答“y”或“Y”，则放弃执行命令；
	-path<范本样式>：指定字符串作为寻找目录的范本样式；
	-perm<权限数值>：查找符合指定的权限数值的文件或目录；
	-print：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式为每列一个名称，每个名称前皆有“./”字符串；
	-print0：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式为全部的名称皆在同一行；
	-printf<输出格式>：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式可以自行指定；
	-prune：不寻找字符串作为寻找文件或目录的范本样式;
	-regex<范本样式>：指定字符串作为寻找文件或目录的范本样式；
	-size<文件大小>：查找符合指定的文件大小的文件；
	-true：将find指令的回传值皆设为True；
	-type<文件类型>：只寻找符合指定的文件类型的文件；
	-uid<用户识别码>：查找符合指定的用户识别码的文件或目录；
	-used<日数>：查找文件或目录被更改之后在指定时间曾被存取过的文件或目录，单位以日计算；
	-user<拥有者名称>：查找符和指定的拥有者名称的文件或目录；
	-version或——version：显示版本信息；
	-xdev：将范围局限在先行的文件系统中；
	-xtype<文件类型>：此参数的效果和指定“-type”参数类似，差别在于它针对符号连接检查。
	```
	- 参数: 起始目录：查找文件的起始目录。

- **实例**
	- 根据文件或者正则表达式进行匹配
	```
	find .  列出当前目录及子目录下所有文件和文件夹
	find /home -name "*.txt" 在/home目录下查找以.txt结尾的文件名
	find /home -iname "*.txt" 同上,但忽略大小写
	find . -name "*.txt" -o -name "*.pdf"  当前目录及子目录下查找所有以.txt和.pdf结尾的文件
	find /usr/ -path "*local*"  匹配文件路径或者文件
	find /home ! -name "*.txt"  找出/home下不是以.txt结尾的文件
	```
	- 根据文件类型进行搜索
	```
	find . -type 类型参数
	类型参数列表：
		f 普通文件
		l 符号连接
		d 目录
		c 字符设备
		b 块设备
		s 套接字
		p Fifo
	```
	- 基于目录深度搜索
	```
	find . -maxdepth 3 -type f  向下最大深度限制为3
	```
	- 根据文件时间戳进行搜索
	```
	find . -type f 时间戳
	find . -type f -atime -7   搜索最近七天内被访问过的所有文件
	find . -type f -atime 7    搜索恰好在七天前被访问过的所有文件
	```
	- 根据文件大小进行匹配
	```
	find . -type f -size 文件大小单元
		文件大小单元：
		b —— 块（512字节）
		c —— 字节
		w —— 字（2字节）
		k —— 千字节
		M —— 兆字节
		G —— 吉字节
	find . -type f -size +10k     搜索大于10KB的文件
	find . -type f -size 10k  	搜索等于10KB的文件
	find . -type f -size -10k 	搜索小于10KB的文件
	```
	- 根据文件权限/所有权进行匹配
	```
	find . -type f -perm 777   当前目录下搜索出权限为777的文件
	find . -type f -user tom   找出当前目录用户tom拥有的所有文件
	find . -type f -group sunk  找出当前目录用户组sunk拥有的所有文件
	```
	- 其他
	```
	find . -empty 要列出所有长度为零的文件
	find . | xargs grep pattern: 根据文件内容查询
	```

### which
- **定义**: which命令用于查找并显示给定命令的绝对路径，环境变量PATH中保存了查找命令时需要遍历的目录。which指令会在环境变量$PATH设置的目录里查找符合条件的文件。也就是说，使用which命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令。
- **格式**: which(选项)(参数)
	- 选项:
	```
	-n<文件名长度>：制定文件名长度，指定的长度必须大于或等于所有文件中最长的文件名；
	-p<文件名长度>：与-n参数相同，但此处的<文件名长度>包含了文件的路径；
	-w：指定输出时栏位的宽度；
	-V：显示版本信息。
	```
	- 参数:
	```
	指令名：指令名列表。
	```
- **实例**: 
	```
	which pwd
	[root@localhost ~]# which pwd
	/bin/pwd
	[root@localhost ~]#  which adduser
	/usr/sbin/adduser
	```
- **说明**:
	which是根据使用者所配置的 PATH 变量内的目录去搜寻可运行档的！所以，不同的 PATH 配置内容所找到的命令当然不一样的.

### whereis
- **定义**:  
whereis命令用来定位指令的二进制程序、源代码文件和man手册页等相关文件的路径。
whereis命令只能用于程序名的搜索，而且只搜索二进制文件（参数-b）、man说明文件（参数-m）和源代码文件（参数-s）。如果省略参数，则返回所有信息。
和find相比，whereis查找的速度非常快，这是因为linux系统会将 系统内的所有文件都记录在一个数据库文件中，当使用whereis和下面即将介绍的locate时，会从数据库中查找数据，而不是像find命令那样，通 过遍历硬盘来查找，效率自然会很高。 但是该数据库文件并不是实时更新，默认情况下时一星期更新一次，因此，我们在用whereis和locate 查找文件时，有时会找到已经被删除的数据，或者刚刚建立文件，却无法查找到，原因就是因为数据库文件没有被更新

- **格式**: whereis(选项)(参数)
	- 选项
	```
	-b：只查找二进制文件；
	-B<目录>：只在设置的目录下查找二进制文件；
	-f：不显示文件名前的路径名称；
	-m：只查找说明文件；
	-M<目录>：只在设置的目录下查找说明文件；
	-s：只查找原始代码文件；
	-S<目录>只在设置的目录下查找原始代码文件；
	-u：查找不包含指定类型的文件。
	```
	- 参数: 指令名：要查找的二进制程序、源文件和man手册页的指令名。

- **实例**:
	```
	[root@localhost ~]# whereis tomcat
	tomcat:
	[root@localhost ~]# whereis svn
	svn: /usr/bin/svn /usr/local/svn /usr/share/man/man1/svn.1.gz
	```
	说明：tomcat没安装，找不出来，svn安装找出了很多相关文件
	```
	[root@localhost ~]# whereis -b svn
	svn: /usr/bin/svn /usr/local/svn
	[root@localhost ~]# whereis -m svn
	svn: /usr/share/man/man1/svn.1.gz
	[root@localhost ~]# whereis -s svn
	svn:
	```
	说明：whereis -m svn查出说明文档路径，whereis -s svn找source源文件。

### locate/slocate命令
- **定义**: 
	locate命令和slocate命令都用来查找文件或目录。  
	locate命令其实是find -name的另一种写法，但是要比后者快得多，原因在于它不搜索具体目录，而是搜索一个数据库/var/lib/locatedb，这个数据库中含有本地所有文件信息。Linux系统自动创建这个数据库，并且每天自动更新一次，所以使用locate命令查不到最新变动过的文件。为了避免这种情况，可以在使用locate之前，先使用updatedb命令，手动更新数据库。
- **格式**: locate/slocate(选项)(参数)
	- 选项:
		```
		-d<目录>或--database=<目录>：指定数据库所在的目录；
		-u：更新slocate数据库；
		--help：显示帮助；
		--version：显示版本信息。
		```
	- 参数: 查找字符串：要查找的文件名中含有的字符串。
- **实例**:
	- 搜索etc目录下所有以sh开头的文件：
	```
	locate /etc/sh
	```
	- 搜索用户主目录下，所有以m开头的文件：
	```
	locate ~/m
	```
	- 搜索用户主目录下，所有以m开头的文件，并且忽略大小写：

	```
	locate -i ~/m
	```

### ps
- **定义**:  
	ps命令进程和作业管理。
	ps命令用于报告当前系统的进程状态。可以搭配kill指令随时中断、删除不必要的程序。ps命令是最基本同时也是非常强大的进程查看命令，使用该命令可以确定有哪些进程正在运行和运行的状态、进程是否结束、进程有没有僵死、哪些进程占用了过多的资源等等，总之大部分信息都是可以通过执行该命令得到的。
- **格式**: ps(选项)
	- 选项太多,linux可通过--help查看,在此不一一列举.

### grep
- **定义**: grep（global search regular expression(RE) and print out the line，全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。
- **格式**: grep (选项). 选项太多,在此不一一列出,可通过参数help查看
- **实例**:
	- 在文件中搜索一个单词，命令会返回一个包含“match_pattern”的文本行：
	```
	grep match_pattern file_name
	grep "match_pattern" file_name
	```
	- 在多个文件中查找：
	```
	grep "match_pattern" file_1 file_2 file_3 ...
	```

### 说明
  mac和linux执行本文中命令会有些许差别,比如whereis在mac上不支持选项,在linux上支持

### 参考文献:
[https://man.linuxde.net/find](https://man.linuxde.net/find)
[https://man.linuxde.net/grep](https://man.linuxde.net/grep)
[https://man.linuxde.net](https://man.linuxde.net/grep)

